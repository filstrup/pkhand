<!DOCTYPE html>
<html>
<body>
<script language="javascript" type="text/javascript">
<!--
/*
  Straight flush > Four > Full > Flush > Straight > Three > Two pair > Pair > High card
*/

function generate_card(list)
{
  var result = false;
  var result2;
  var result3;
  var i;
  var j;

  while(!result)
  {
    result2 = false;
    result3 = true;
    i = Math.floor(Math.random() * 13) + 1;
    j = Math.floor(Math.random() * 4) + 1;
    
    for(var k=0; (k < list.length) && (!result2) && (!result3); k++)
    {
      result3 = false;
      if(list[k] == [i, j])
        result2 = true;
      if(k == list.length -1 && !result2)
        result3 = true;
    }
    result = result3;
  }
  if(j == 1)
    j = "spades";
  else if(j == 2)
    j = "hearts";
  else if(j == 3)
    j = "diamonds";
  else if(j == 4)
    j = "clubs";
  return [i, j];
}

function generate_hand(number)
{
  list = [];
  for(i = 1; i <= number; i++)
  {
    list[i] = generate_card(list);
  }
  for(i = 1; i <= number; i++)
  {
    console.log(list[i]);
  }
  return list;
}

function error(arg)
{
  console.log(arg);
}

function hand (list){

  var cards13 = [];
  for(i = 1; i <= 13; i++)
    cards13[i] = 0;

  var cards4 = [];
  for(i = 1; i <= 4; i++)
    cards4[i] = 0;
  
  for(i = 1; i < list.length; i++){
    cont = cards13[list[i][0]];
    cards13[list[i][0]] += 1;
    cards4 = increase4(cont, cards4);
  }
  cards13[0] = list.length - 1;
  cards4[0] = 0;

  bestplay(cards13, cards4);
}

function increase4(number, list)
{
  switch(number)
  {

    case 0:
      list[1] += 1;
      return list;
      break;

    case 1:
      list[1] -= 1;
      list[2] += 1;
      return list;
      break;

    case 2:
      list[2] -= 1;
      list[3] += 1;
      return list;
      break;

    case 3:
      list[3] -= 1;
      list[4] += 1;
      return list;
      break;

    default:
      error("Error en increase4 con argumento del switch = " + number);
      break;
  }
}

function bestplay(cards, count)
{
  console.log(cards);
  console.log(count);
  console.log(cards[0]);
  switch(cards[0])
  {

    case 5:
      if (arraysIdentical(count, [0,1,0,0,1]))
      {
        poker(cards, count);
      }

      else if (arraysIdentical(count, [0,0,1,1,0]))
      {
        full(cards, count);
      }

      else if (arraysIdentical(count, [0,2,0,1,0]))
      {
        trio(cards, count);
      }

      else if (arraysIdentical(count, [0,1,2,0,0]))
      {
        doble(cards, count);
      }

      else if (arraysIdentical(count, [0,3,1,0,0]))
      {
        pareja(cards, count);
      }

      else
      {
        escalera(cards, count);
      }

      break;

    case 6:

      var result = false;

      if (arraysIdentical(count, [0,2,0,0,1]))
      {
        poker(cards, count);
        
      }

      else if (arraysIdentical(count, [0,1,1,1,0]))
      {
        full(cards, count);
      }

      else if(escalera(cards, count)[0] == 1)
      {
        s = escalera(cards, count)[1];
        console.log("Escalera de " + (s-4) + " a " + (s));
      }

      else if (arraysIdentical(count, [0,3,0,1,0]))
      {
        trio(cards, count);
      }

      else if (arraysIdentical(count, [0,2,2,0,0]))
      {
        doble(cards, count);
      }

      else if (arraysIdentical(count, [0,4,1,0,0]))
      {
        pareja(cards, count);
      }


      break;

    case 7:

      if (arraysIdentical(count, [0,3,0,0,1]))
      {
        poker(cards, count);
      }

      else if (arraysIdentical(count, [0,2,1,1,0]))
      {
        full(cards, count);
      }

      else if (arraysIdentical(count, [0,4,0,1,0]))
      {
        trio(cards, count);
      }

      else if (arraysIdentical(count, [0,3,2,0,0]))
      {
        doble(cards, count);
      }

      else if (arraysIdentical(count, [0,5,1,0,0]))
      {
        pareja(cards, count);
      }

      else
      {
        escalera(cards, count);
      }

      break;
 
    default:
      error("Error en el numero de cartas en la mano = " + cards[0]);
      break;
  }
}

function poker(cards, count)
{
  hc = 0;
  result = false;
  for(i = 1; !result; i++)
  {
    result = (cards[i] == 4);
    hc = i;
  }
  play = "Poker de " + hc;
  console.log(play);
}

function full(cards, count)
{
  hc = 0;
  hc2 = 0;
  result = false;
  result2 = false;
  for(i = 1; !result || !result2 ; i++)
  {
    if(cards[i] == 3)
    {
    result = true;
    hc = i; 
    }
    if(cards[i] == 2)
    {
    result2 = true;
    hc2 = i; 
    }
  }
  play = "Full de " + hc + " (trio) y " + hc2 + " (pareja)";
  console.log(play);
}

function trio(cards, count)
{
  hc = 0;
  result = false;
  for(i = 1; !result; i++)
  {
    result = (cards[i] == 3);
    hc = i;
  }
  play = "Trio de " + hc;
  console.log(play);
}

function doble(cards, count)
{
  hc = 0;
  hc2 = 0;
  result = false;
  result2 = false;
  for(i = 1; !result || !result2 ; i++)
  {
    if(cards[i] == 2 && !result)
    {
      result = true;
      hc = i; 
    }
    else if(cards[i] == 2 && result)
    {
      result2 = true;
      hc2 = i; 
    }
  }
  play = "Parejas dobles " + hc + " y " + hc2;
  console.log(play);
}

function pareja(cards, count)
{
  hc = 0;
  result = false;
  for(i = 1; !result; i++)
  {
    result = (cards[i] == 2);
    hc = i;
  }
  play = "Pareja de " + hc;
  console.log(play);
}

function escalera(cards, count)
{
  k = 0;
  s = 0;
  for(i = 1; i <= cards.length; i++)
  {
    if (cards[i] == 1)
    {
      k++;
      if(k >= 5){ s = i; }
    }
    else if(cards[i] == 0)
    {
      k = 0;
    }
  }
  if(s!=0){ return [1, s]; }
  else{ return [0, 0]; }
}

function arraysIdentical(a, b) {
    var i = a.length;
    if (i != b.length) return false;
    while (i--) {
        if (a[i] !== b[i]) return false;
    }
    return true;
}

hand([6, [4, "hearts"], [6, "hearts"], [7, "hearts"], [5, "hearts"], [8, "hearts"], [5, "hearts"]])
//-->
</script>
</body>
</html> 

